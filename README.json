{
  "project": {
    "name": "kofujimura.github.io",
    "description": "Next.js製の静的サイト（ヘッドレスCMS）",
    "type": "website",
    "tech_stack": ["Next.js 15", "TypeScript", "Tailwind CSS", "Sharp"],
    "hosting": "GitHub Pages",
    "deployment": "GitHub Actions",
    "url": "https://kofujimura.github.io/"
  },
  "ai_agent_info": {
    "purpose": "記事投稿とサイト管理の自動化",
    "capabilities": [
      "記事作成・投稿",
      "画像管理・最適化",
      "デプロイメント",
      "コンテンツ管理"
    ],
    "context_understanding": {
      "cms_type": "headless",
      "data_storage": "JSON files",
      "content_format": "HTML in JSON"
    }
  },
  "file_structure": {
    "content_data": {
      "posts": "src/data/posts.json",
      "pages": "src/data/pages.json",
      "attachments": "src/data/attachments.json"
    },
    "scripts": {
      "create_post": "scripts/create-post.js",
      "get_next_id": "scripts/get-next-id.js",
      "migrate_images": "scripts/migrate-images.js",
      "optimize_images": "scripts/optimize-images.ts"
    },
    "assets": {
      "new_images": "public/images/",
      "legacy_images": "public/wp-content/uploads/"
    }
  },
  "operations": {
    "post_creation": {
      "method": "script",
      "command": "node scripts/create-post.js add-direct",
      "input_format": "JSON string",
      "data_handling": "既存posts.jsonに新記事を追記（上書きしない）",
      "safety_features": ["ID重複チェック", "既存データ保護", "配列先頭への追記"],
      "required_fields": ["title"],
      "optional_fields": ["content", "categories", "tags", "featuredImageUrl", "excerpt"],
      "auto_generated": ["id", "date", "slug"]
    },
    "deployment": {
      "trigger": "git push to main branch",
      "automation": "GitHub Actions",
      "duration": "2-3 minutes",
      "git_workflow": [
        "git add .",
        "git commit -m 'message'",
        "git push origin main"
      ]
    }
  },
  "data_schemas": {
    "post": {
      "id": "number (auto-generated)",
      "title": "string (required)",
      "content": "string (HTML, required)",
      "excerpt": "string (optional)",
      "date": "string (ISO 8601, auto-generated)",
      "modified": "string (ISO 8601, auto-generated)",
      "slug": "string (auto-generated)",
      "status": "string (default: 'publish')",
      "author": "string (default: 'fujimura')",
      "categories": "array of strings",
      "tags": "array of strings",
      "featuredImageUrl": "string (URL, optional)"
    }
  },
  "ai_workflows": {
    "quick_post": {
      "description": "AIエージェント向けの最速投稿方法（既存記事を保持して追記）",
      "steps": [
        "create-post.js add-direct でJSON投稿（既存データに追記）",
        "git操作でデプロイ"
      ],
      "example_command": "node scripts/create-post.js add-direct '{\"title\":\"AI記事\",\"content\":\"<p>内容</p>\"}'',
      "note": "既存記事を保持しつつ新記事を配列先頭に追加",
      "warning": "posts.jsonファイル全体を上書きせず、既存データに追記処理を行う"
    },
    "image_handling": {
      "upload_location": "public/images/",
      "reference_format": "/images/filename.jpg",
      "requirements": {
        "minimum_size": "1280px以上の幅を推奨（960w/1280wファイル生成のため）",
        "supported_formats": ["PNG", "JPEG", "JPG"],
        "naming_convention": "英数字とハイフンのみ（日本語不可）"
      },
      "optimization": {
        "formats": ["AVIF", "WebP", "Original format"],
        "responsive_sizes": [320, 640, 960, 1280],
        "compression": "80% quality",
        "automation": "ビルド時自動実行（npx tsx scripts/optimize-images.ts）",
        "manual_command": "npx tsx scripts/optimize-images.ts",
        "file_size_reduction": "90-99%の削減効果"
      },
      "display_behavior": {
        "top_page": "3カラムグリッド用（sizes: 33vw）",
        "article_page": "コンテンツ用（sizes: 800px固定）",
        "browser_selection": "AVIF → WebP → Original の優先順位"
      },
      "components": {
        "react": "src/components/OptimizedImage.tsx",
        "html_processing": "src/utils/imageUtils.ts"
      },
      "fallback_strategy": {
        "missing_sizes": "小さいサイズから自動コピー生成",
        "old_images": "オリジナルファイルをそのまま使用",
        "error_handling": "元画像への自動フォールバック"
      }
    }
  },
  "limitations": {
    "github_api": "API rate limits apply",
    "file_size": "GitHub file size limits",
    "deployment": "GitHub Actions usage limits"
  },
  "troubleshooting": {
    "build_failure": "Check GitHub Actions logs",
    "deployment_delay": "Wait 2-3 minutes for GitHub Pages",
    "json_syntax": "Validate JSON before commit",
    "data_loss_prevention": "add-directコマンドは既存データを保護し追記のみ実行"
  },
  "meta": {
    "version": "1.3",
    "last_updated": "2025-08-07",
    "ai_context_preserved": true,
    "human_readable_docs": "README.md",
    "changelog": {
      "v1.3": "画像最適化システム完成（4サイズ対応、表示サイズ最適化、フォールバック強化）",
      "v1.2": "画像最適化システム追加（AVIF/WebP生成、レスポンシブ対応、自動化）",
      "v1.1": "データ保護とAgent誤解防止のための記載を明確化"
    }
  }
}